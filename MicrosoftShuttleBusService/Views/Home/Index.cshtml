@{
    ViewBag.Title = "Home Page";
}
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=AxXlQ1BehjgOnV5GflqAjrs46iawMsUE"></script>
<script src="http://d1.lashouimg.com/static/js/release/jquery-1.4.2.min.js" type="text/javascript"></script>

<div class="main map" style="width:100%;height:100%">
    @*<p>显示地图</p>*@
    <div style="width:100%;height:100%;border:1px solid gray" id="main_map"></div>
</div>

<div class="container main">
    <div class="row">
        <div class="col-md-10">
            <div class="row">
                <div id ="searchDiv"class="col-md-3" style="">
                    <div class="input-group">
                        <input id="searchForInput" type="text" class="form-control" placeholder="Search for...">
                        <span class="input-group-btn">
                            <button id="searchButton" class="btn btn-default" type="button">
                                <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                            </button><!-- /searchButton -->
                        </span>
                        <span class="input-group-btn">
                            <button id ="detailRouteButton" class="btn btn-default" type="button">
                                <span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>
                            </button><!-- /detailRouteButton -->
                        </span>
                        <span class="input-group-btn">
                            <button id="newSiteButton" class="btn btn-default" type="button">
                                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
                            </button><!-- /newSiteButton -->
                        </span>
                    </div><!-- /input-group -->
                </div><!-- /searchDiv -->

                <div id="routeDetailDiv"class="col-md-3" style="display:none">
                    <div class="col-md-offset-11">
                        <span class="input-group-btn">
                            <button id="returnFromRouteDetailButton" class="btn btn-default" type="button">
                                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span><!-- return -->
                            </button>
                        </span>
                    </div><!-- /returnDiv -->
                    <div class="input-group">
                        <input id="sourceInput" type="text" class="form-control" placeholder="Source" aria-describedby="basic-addon1">
                        <span class="input-group-btn">
                            <span class="glyphicon glyphicon-sort" aria-hidden="true">
                                <button id="exchangeButton" class="btn btn-default" type="button">
                                    <span class="glyphicon glyphicon-sort" aria-hidden="true"></span>
                                </button>
                            </span>
                        </span>
                    </div><!-- /sourceDiv -->
                    <div class="input-group">
                        <input id="destinationInput" type="text" class="form-control" placeholder="Destination" aria-describedby="basic-addon1">
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button" onclick="search()">
                                <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                            </button>
                        </span>
                    </div><!-- /destinationDiv -->
                    <div id="route_result">
                    </div><!-- /routeInfoDiv -->
                </div><!-- /routeDeatailDiv -->

                <div id="newSiteDiv" class="col-md-3" style="display:none">
                    <div class="col-md-offset-11">
                        <span class="input-group-btn">
                            <button id="returnFromNewSiteButton" class="btn btn-default" type="button">
                                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span><!-- return -->
                            </button>
                        </span>
                    </div><!-- /returnDiv -->
                    <div class="input-group soloInput">
                        <input id="aliasInput" type="text" class="form-control" placeholder="Alias" aria-describedby="basic-addon1">
                    </div><!-- /aliasDiv -->
                    <div class="input-group soloInput">
                        <input id="emailInput" type="text" class="form-control" placeholder="Email" aria-describedby="basic-addon1">
                    </div><!-- /emailDiv -->
                    <div class="input-group">
                        <input id="positionInput" type="text" class="form-control" placeholder="Position" aria-describedby="basic-addon1">
                        <span class="input-group-btn">
                            <button id="searchPositionButton" class="btn btn-default" type="button">
                                <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
                            </button><!-- /searchPositionButton -->
                        </span>
                    </div><!-- /positionDiv -->
                    <div>
                        <div class="row detail">
                            </br>
                            <p>人员信息1</p>
                            </br>
                        </div>
                        <div class="row detail">
                            </br>
                            <p>人员信息2</p>
                            </br>
                        </div>
                        <div class="row detail">
                            </br>
                            <p>人员信息3</p>
                            </br>
                        </div>
                    </div><!-- /routeInfoDiv -->
                </div><!-- /newSiteDiv -->
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $("#detailRouteButton").click(function () {
            $("#searchDiv").css("display", "none");
            $("#routeDetailDiv").css("display", "");
            $("#sourceInput").val($("#searchForInput").val());
        });

        $("#searchButton").click(function () {
            $("#searchDiv").css("display", "none");
            $("#routeDetailDiv").css("display", "");
            $("#sourceInput").val($("#searchForInput").val());
            localSearch();
        });

        $("#newSiteButton").click(function () {
            $("#searchDiv").css("display", "none");
            $("#newSiteDiv").css("display", "");
        });

        $("#returnFromRouteDetailButton").click(function () {
            $("#searchDiv").css("display", "");
            $("#routeDetailDiv").css("display", "none");
        });

        $("#returnFromNewSiteButton").click(function () {
            $("#searchDiv").css("display", "");
            $("#newSiteDiv").css("display", "none");
        });

        $("#exchangeButton").click(function () {
            var temp = $("#sourceInput").val();
            $("#sourceInput").val($("#destinationInput").val());
            $("#destinationInput").val(temp);
        });
    });
</script>

<script type="text/javascript">
    function Station (name, photo, route, routeTime, longitude, latitude) {
        this.name = name;
        this.photo = photo;
        this.route = route;
        this.routeTime = routeTime;
        this.longitude = longitude;
        this.latitude = latitude;
    }

    var markersForStation = new Array();
    var datas = new Array();
    datas[0] = (new Station("虹桥路宜山路", "http://static.shenjianshou.cn/images/11666-daabbc70ddb73cf96afab7721c97edf0", "Route 11", "11:00am", 121.3511167, 31));
    datas[1] = (new Station("张江路建中路", "https://encrypted-tbn2.gstatic.com/images?q=tbn:ANd9GcQdSYfLw8bJOpPSVOfhBLTSwF04xrCX_rlfUO8SXS_5OyrkaUZV", "Route 8", "8:00am", 121.4511167, 31));

    // create a baidu map
    // The divID is the ID of the div which gonna show the map
    function createMap(divID, longitude, latitude) {
        map = new BMap.Map(divID);
        map.centerAndZoom(new BMap.Point(longitude, latitude), 13);
        map.enableScrollWheelZoom();
        return map;
    }

    var map = createMap("main_map", 121.4511167, 31);
    addMarkersInBaiduMap(datas, map);
    // datas contain all the info for each station
    function addMarkersInBaiduMap(datas, map) {
        for (i = 0; i < datas.length; i++) {
            markersForStation.push(new BMap.Marker(new BMap.Point(datas[i].longitude, datas[i].latitude)));
            map.addOverlay(markersForStation[i]);
            markersForStation[i].licontent = "<div style=\"width:500px;height:200px;\"><div style=\"float:left\"><img src=\"" + datas[i].photo +
                            "\" style=\"width:300px;height:200px;\"></div><div style=\"float:right;width:180px;height:200px;\"><h3>" +
                            datas[i].name + "</h3><span><strong>班车线路:</strong> " + datas[i].route + "</span> <br /><span><strong>到站时间:</strong> " + datas[i].routeTime + "</span></div></div>";
            markersForStation[i].opts1 = { width: 500 };
            markersForStation[i].infoWindow = new BMap.InfoWindow(markersForStation[i].licontent, markersForStation[i].opts1);
            markersForStation[i].addEventListener('click', function () {
                this.openInfoWindow(this.infoWindow);
            });
        }
    }

    function deleteMarkersInBaiduMap(map) {
        for (i = 0; i < markersForStation.length; i++)
            map.removeOverlay(markersForStation[i]);
    }

    function createTransit(map) {
        var transit = new BMap.TransitRoute(map, {
            renderOptions: { map: map, panel: "route_result" }
        });
        return transit;
    }

    function searchTransit(map, transit, origin, destination) {
        map.centerAndZoom(new BMap.Point(121.476788, 31.23754), 12);
        transit.search(origin, destination);
    }

    function search() {
        var transit = createTransit(map);
        searchTransit(map, transit, $("#sourceInput").val(), $("#destinationInput").val());
    }

    function createLocalSearch(map) {
        /// It's the same usage as the transit search, you can add a callback here or use getResults() after search.
        /// The return type of getResults is LocalResult or array of LocalResult.
        /// links: 1) http://developer.baidu.com/map/reference/index.php?title=Class:%E6%9C%8D%E5%8A%A1%E7%B1%BB/LocalSearch
        ///        2) http://developer.baidu.com/map/reference/index.php?title=Class:%E6%9C%8D%E5%8A%A1%E7%B1%BB/LocalResult

        var options = {
            onSearchComplete: function (results) {
                if (local.getStatus() == BMAP_STATUS_SUCCESS) {
                    // 判断状态是否正确
                    var s = [];
                    for (var i = 0; i < results.getCurrentNumPois() ; i++) {
                        s.push(results.getPoi(i).title + ", " + results.getPoi(i).address);
                    }
                    document.getElementById("route_result").innerHTML = s.join("<br>");
                }
            },
            
            renderOptions: { map: map, autoViewport: true, panel: "route_result" }
            
        };
        var local = new BMap.LocalSearch(map, options);
        return local;
    }

    function localSearch() {
        var local_search = createLocalSearch(map);
        local_search.search($("#sourceInput").val());
    }

    var p1 = new BMap.Point(121.476788, 31.23754);
    var p2 = new BMap.Point(121.476788, 30.23754);
    var p3 = new BMap.Point(121.476788, 31.03754);

    var driving = new BMap.DrivingRoute(map, { renderOptions: { map: map, autoViewport: true } });
    driving.search(p1, p2, { waypoints: [p3] });//waypoints表示途经点

</script>